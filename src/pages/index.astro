---
import Layout from "@layouts/Layout.astro";
import Container from "@components/Container.astro";
import { SITE, HOME, SOCIALS } from "@consts";
import ArrowCard from "@components/ArrowCard.astro";
import Link from "@components/Link.astro";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

const stories = (await getCollection("stories"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_POSTS_ON_HOMEPAGE);
---

<Layout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <aside data-pagefind-ignore>
      <h1 class="home-title">
        Introducing Astro Micro ðŸ”¬
      </h1>
      <div class="home-container">
        <section>
          <em>
            Bienvenue, mes amis! I've always loved writing, and traveling, and
            talking to people of all walks of life. I realized I had many
            stories that I've polished over the years, and decided to write them
            down. My memory may be hazy, and I've changed some names and places
            for privacy reasons, but I promise they're mostly true. As true as
            the size of the fish I caught last week.
          </em>
        </section>

        <section class="animate home-section">
          <div class="home-section-header">
            <h2 class="home-section-title">
              Latest stories
            </h2>
            <Link href="/stories"> See all stories </Link>
          </div>
          <ul class="not-prose home-stories-list">
            {
              stories.map((post) => (
                <li>
                  <ArrowCard entry={post} />
                </li>
              ))
            }
          </ul>
        </section>

        <section class="animate home-section">
          <h2 class="home-section-title">
            Let's Connect
          </h2>
          <article>
            <p>
              If you want to get in touch with me about something or just to say
              hi, reach out on social media or send me an email. I'm near
              Geneva, Switzerland, mostly these days.
            </p>
          </article>
          <ul class="not-prose home-socials-list">
            {
              SOCIALS.map((SOCIAL) => (
                <li class="home-social-item">
                  <Link
                    href={SOCIAL.HREF}
                    external
                    aria-label={`${SITE.TITLE} on ${SOCIAL.NAME}`}
                  >
                    {SOCIAL.NAME}
                  </Link>
                  {"/"}
                </li>
              ))
            }
            <li class="home-email-item">
              <Link
                href={`mailto:${SITE.EMAIL}`}
                aria-label={`Email ${SITE.TITLE}`}
              >
                {SITE.EMAIL}
              </Link>
            </li>
          </ul>
        </section>
      </div>
    </aside>
  </Container>
</Layout>
