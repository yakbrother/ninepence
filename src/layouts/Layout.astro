---
import Head from "@components/Head.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import FooterDivider from "@components/FooterDivider.astro";
import { SITE } from "@consts";

type Props = {
  title: string;
  description: string;
  image?: string;
};

const { title, description, image } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <Head
      title={`${title} | ${SITE.TITLE}`}
      description={description}
      image={image}
    />
  </head>
  <body>
    <Header />
    <main>
      <slot />
    </main>
    <FooterDivider />
    <Footer />
    <script is:inline>
      // Theme toggle functionality
      (function () {
        const themeToggle = document.getElementById("theme-toggle-checkbox");
        const html = document.documentElement;

        // Check for saved user preference, if any, on load
        const savedTheme = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)",
        ).matches;

        // Apply the saved theme, or fall back to system preference
        if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
          html.classList.add("dark");
          if (themeToggle) themeToggle.checked = true;
        }

        // Toggle theme when checkbox is clicked
        if (themeToggle) {
          themeToggle.addEventListener("change", function () {
            if (this.checked) {
              html.classList.add("dark");
              localStorage.setItem("theme", "dark");
            } else {
              html.classList.remove("dark");
              localStorage.setItem("theme", "light");
            }
          });
        }
      })();
    </script>
  </body>
</html>
